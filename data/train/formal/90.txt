For simplicity, we assume that the graph is connected, giving us O(mlgn).
